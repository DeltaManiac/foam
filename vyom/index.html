<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/foam/styles.2e98cd11f42589b7a982.css">.popover{position:relative;max-width:16rem;box-shadow:0 10px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05);padding:1rem;border:1px solid var(--separator);border-radius:.5rem;background-color:var(--references-bg);max-height:16rem;overflow:hidden}.popover.no-max-width{max-width:90vw}.popover.with-markdown{font-size:.875rem}.popover h1{margin:0;padding:0;font-size:1rem}.popover ul{padding-left:1rem}.popover .more-content-blind{height:4rem;position:absolute;background:transparent;background:linear-gradient(0,var(--references-bg),var(--references-bg-80) 50%,var(--references-bg-0));top:12rem;width:100%;left:0}.tippy-box[data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=top]{transform:translateY(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=bottom]{transform:translateY(-10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=left]{transform:translateX(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=right]{transform:translateX(-10px)}.reference{text-decoration:none}.reference:hover{color:var(--references-highlight)}.reference>div{padding-top:.5rem;padding-bottom:.5rem}.reference>div>p{margin:0;font-size:.875rem}.reference>div>ul{margin:0}.references-block{color:var(--references-text);padding:1rem;margin:1rem 0;border-radius:.5rem;background-color:var(--references-bg);transition:background-color .3s ease,color .3s ease}.references-block>div{margin-bottom:1rem}.references-block>hr{margin-left:auto;margin-right:auto;width:8rem}.references-block a{color:var(--references-text);transition:color .3s ease}.references-block>p:last-child{margin-bottom:0}.note-container{background:var(--note-bg);transition:background .3s ease}.note-container:first-child{border-left:none}.note-container .note-content,.note-container .obstructed-label{transition:opacity 75ms linear}.note-container .obstructed-label{display:block;color:var(--text);text-decoration:none;font-size:17px;line-height:40px;font-weight:500;-ms-writing-mode:tb-lr;writing-mode:vertical-lr;margin-top:36px;top:0;bottom:0;left:0;position:absolute;background-color:transparent;width:40px;overflow:hidden;opacity:0;transition:color .3s ease;pointer-events:none}.note-container.note-container-highlighted{background:var(--references-bg);transition:background .3s ease}.note-content img{max-width:100%}@media screen and (max-width:800px){.note-container{padding:16px;width:100%;overflow-y:auto}}@media screen and (min-width:801px){.note-container{transition:box-shadow .1s linear,opacity 75ms linear,transform .2s cubic-bezier(.19,1,.22,1);flex-shrink:0;width:625px;max-width:625px;top:0;position:-webkit-sticky;position:sticky;flex-grow:1;border-left:1px solid var(--separator);padding:0}.note-content{overflow-y:auto;height:100%;padding:32px}.note-container-overlay{box-shadow:0 0 15px 3px var(--shadow)}.note-container-obstructed .note-content{opacity:0}.note-container-obstructed .obstructed-label{opacity:1;pointer-events:all}}.dark-mode-toggle{cursor:pointer;transform:scale(.6)}.dark-mode-toggle input{display:none}.dark-mode-toggle input+div{border-radius:50%;width:36px;height:36px;position:relative;box-shadow:inset 16px -16px 0 0 #fff;transform:scale(1) rotate(-2deg);transition:box-shadow .5s ease 0s,transform .4s ease .1s}.dark-mode-toggle input+div:before{content:"";width:inherit;height:inherit;border-radius:inherit;position:absolute;left:0;top:0;transition:background .3s ease}.dark-mode-toggle input+div:after{content:"";width:8px;height:8px;border-radius:50%;margin:-4px 0 0 -4px;position:absolute;top:50%;left:50%;box-shadow:0 -23px 0 var(--link),0 23px 0 var(--link),23px 0 0 var(--link),-23px 0 0 var(--link),15px 15px 0 var(--link),-15px 15px 0 var(--link),15px -15px 0 var(--link),-15px -15px 0 var(--link);transform:scale(0);transition:all .3s ease}.dark-mode-toggle input:checked+div{box-shadow:inset 32px -32px 0 0 #fff;transform:scale(.5) rotate(0deg);transition:transform .3s ease .1s,box-shadow .2s ease 0s}.dark-mode-toggle input:checked+:before{background:var(--link);transition:background .3s ease .1s}.dark-mode-toggle input:checked+:after{transform:scale(1.5);transition:transform .5s ease .15s}.graph-button{border:0;background:none;cursor:pointer}.graph-button svg g{stroke:var(--link)}header{width:100%;min-height:57px;z-index:5;background-color:var(--note-bg);border-bottom:1px solid var(--separator);display:flex;justify-content:space-between;align-items:center;padding:10px 32px;flex-wrap:wrap;transition:background-color .3s ease}header>a{font-weight:700;color:var(--text);text-decoration:none;transition:color .3s ease}header .controls{display:flex}html{font-family:system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body.light-mode{--main-bg:#fafafc;--note-bg:#fff;--text:#1a202c;--separator:#e2e8f0;--shadow:rgba(0,0,0,0.1);--link:#3182ce;--references-bg:#ebf4ff;--references-bg-80:rgba(235,244,255,0.8);--references-bg-0:rgba(235,244,255,0);--references-text:#718096;--references-highlight:#4a5568}body.dark-mode{--main-bg:#000;--note-bg:#0a0d11;--text:#fafafc;--separator:#252525;--shadow:hsla(0,0%,100%,0.1);--link:#3da1ff;--references-bg:#17181a;--references-bg-80:rgba(23,24,26,0.8);--references-bg-0:rgba(23,24,26,0);--references-text:#8c9fbb;--references-highlight:#b3cbf0}body{background-color:var(--main-bg);color:var(--text);margin:0;padding:0;height:100vh;transition:background-color .3s ease,color .3s ease}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,p,pre{margin:0}*,:after,:before{box-sizing:border-box}h1,h2,h3{font-weight:700}hr{margin-top:1rem;margin-bottom:1rem;border:solid var(--separator);border-width:1px 0 0;box-sizing:content-box;height:0;overflow:visible}a{color:var(--link);text-decoration:underline;transition:color .3s ease}a:hover{text-decoration:none}h1{font-size:1.875rem;margin-top:1rem}h1,p{margin-bottom:1rem}.layout{height:100vh;display:flex;flex-direction:column}.note-columns-scrolling-container{display:flex;overflow-x:auto;overflow-y:hidden;flex-grow:1}.note-columns-container{display:flex;flex-grow:1;transition:width .1s cubic-bezier(.19,1,.22,1)}@media screen and (max-width:800px){.note-columns-container{width:unset!important}}.overlay{z-index:98;position:fixed;top:0;right:0;bottom:0;left:0;display:flex;align-items:center;justify-content:center;height:100%;width:100%;background-color:var(--shadow);-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal{z-index:99;position:fixed;border-radius:8px;background-color:var(--main-bg);box-shadow:-5px -5px 15px -3px var(--shadow),0 4px 6px -2px rgba(0,0,0,.05)}.modal-close,.modal-scale{position:absolute;top:0;right:0;padding:5px;border:0;background:none;color:var(--text);cursor:pointer}.modal-close svg,.modal-scale svg{width:20px;height:20px}.modal-close path,.modal-scale path{fill:currentColor}.modal-scale{right:30px}.modal-minimized .modal-close svg,.modal-minimized .modal-scale svg{width:15px;height:15px}.modal-minimized .modal-scale{right:25px}.modal-body{height:100%;width:100%}.modal-body .node,.modal-body .text{cursor:pointer}</style><meta name="generator" content="Gatsby 2.24.37"/><link as="script" rel="preload" href="/foam/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-5e093f5807d6eb5ecced.js"/><link as="script" rel="preload" href="/foam/styles-89fd2ae28bdf06750a71.js"/><link as="script" rel="preload" href="/foam/app-a23c3f4de5f92c6458ad.js"/><link as="script" rel="preload" href="/foam/framework-8c8d363c63d1a9a80d21.js"/><link as="script" rel="preload" href="/foam/webpack-runtime-23d80780450712e11cfe.js"/><link as="fetch" rel="preload" href="/foam/page-data/vyom/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/foam/page-data/sq/d/2098632890.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/foam/page-data/sq/d/426988268.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/foam/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout"><header><a href="/foam/"><h3>Foam</h3></a><div class="controls"><button title="Show Graph visualisation" aria-label="Show Graph visualisation" class="graph-button"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20" height="20"><g fill="none" stroke-width="2"><circle cx="11.733" cy="3.181" r="1.902"></circle><circle cx="16.864" cy="10.861" r="1.902"></circle><circle cx="7.47" cy="16.822" r="1.902"></circle><circle cx="3.046" cy="6.275" r="1.902"></circle><circle cx="9.372" cy="10.861" r="1.902"></circle><line x1="11.635" x2="14.655" y1="10.861" y2="10.861"></line><line x1="10" x2="10.895" y1="8.959" y2="5.573"></line><line x1="7.47" x2="4.5" y1="9.68" y2="7.5"></line><line x1="8.25" x2="8.809" y1="14.92" y2="13.088"></line></g></svg></button><label class="dark-mode-toggle" aria-label="Activate dark mode" title="Activate dark mode"><input type="checkbox" checked=""/><div></div></label></div></header><div class="note-columns-scrolling-container"><div class="note-columns-container" style="width:1250px"><div class="note-container   " style="left:0;right:-585px"><div class="note-content"><h1 id="vyom" style="position:relative">Vyom</h1><p>This bot is in [<a href="rust" title="Rust">rust</a>]</p><p>Recently while browsing <a href="https://old.reddit.com">reddit</a> I came up on a <a href="https://www.reddit.com/r/rust/comments/i1satq/webference_rusty_days_2020_all_recorded_talks/g01rwq8/?context=3">post</a> in the <a href="https://old.reddit.com">/r/rust</a> subreddit which was a link to a youtube playlist for the Rust-Wroclaw conference/meetup, however there was no way I could find the contents of the playlist without going to Youtube. This was a nuance so I went to Youtube and curated the list.</p><p><img src="https://dev-to-uploads.s3.amazonaws.com/i/fxof8cdxfizue63qkz7d.png" alt="Manually listing the entries"/></p><p>This was going to be tiresome if I&#x27;d have to do it every time I see a link that is a YouTube playlist. So here we are writing a bot do this task for everyone. This bot will run on a server somewhere (hopefully forever) and curate playlist info for all the people who avail its service.</p><h1 id="creating-credentials-for-our-bot" style="position:relative">Creating Credentials For Our Bot</h1><p>In order to write our bot we first need to get some credentials from reddit so that we can access the <a href="https://old.reddit.com/dev/api">reddit apis</a> programmatically.</p><p>First you need an application id and secret so reddit knows your application. We can get this information by going to <a href="https://www.reddit.com/prefs/apps">preferences/app</a> and clicking <code>are you a developer? create an app...</code> button</p><p>Reddit lets us choose the type of the app we want to build. The three types of app are :</p><ul><li><p>Web app: Runs as part of a web service on a server you control. Can keep a secret.</p></li><li><p>Installed app: Runs on devices you don&#x27;t control, such as the user&#x27;s mobile phone. Cannot keep a secret, and therefore, does not receive one.</p></li><li><p>Script app: Runs on hardware you control, such as your own laptop or server. Can keep a secret. Only has access to your account.</p></li></ul><p>More info about about the apps can be found <a href="https://github.com/reddit-archive/reddit/wiki/oauth2-app-types">here</a>.</p><p>We choose the <code>script</code> type, enter a name and description for our bot, and use  the dummy url <code>http://www.example.com/unused/redirect/uri</code> for the redirect url.</p><p><img src="https://dev-to-uploads.s3.amazonaws.com/i/weyxca7xkhcnfrwo36kj.png" alt="Create App"/></p><p>We have now created the credentials with Client Id : <code>TjC0s2uTaTHYCg</code> and Client Secret : <code>mrkAaWitnXLf_DiRagIRS_33cD8</code>.</p><p><img src="https://dev-to-uploads.s3.amazonaws.com/i/xj0q1m7li5abg060ari6.png" alt="Credentials"/></p><h1 id="using-and-storing-the-credentials" style="position:relative">Using and Storing the credentials</h1><p>We can now use the credentials in our source code and use it in our code.</p><pre><code class="language-rust"># main.rs

static  CLIENT_ID:&amp;str=&quot;TjC0s2uTaTHYCg&quot;;
static  CLIENT_SECRET:&amp;str=&quot;mrkAaWitnXLf_DiRagIRS_33cD8&quot;;

fn main(){
    println!(&quot;Client ID: {}&quot;,CLIENT_ID);
    println!(&quot;Client Secret: {}&quot;,CLIENT_SECRET);
}
</code></pre><pre><code class="language-shell">DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.08s
     Running `target/debug/vyom`
Client ID: SmQ7CzGkKA62yA
Client Secret: UItY35BYBEN_rFVnGVzud9Pig6g
</code></pre><p>This is a very easy and clear way to handle credentials but its flawed in two ways.</p><ul><li><p>If we need to change the credentials then we would have to change the code, rebuild the app and redeploy the app.</p></li><li><p>If we decide to share the code with someone or push it github, it will expose our credentials, which can be used to hijack our account and do bad things.</p></li></ul><p>So lets see if we can fix the first problem, by moving the credentials out of the source code. But where do we put it then ? If you&#x27;re thinking about environment variables then youre absolutely right. Environment variables are a good place to store such values and they are fairly easy to change.</p><pre><code class="language-rust"># main.rs

fn main(){
    match std::env::var(&quot;CLIENT_ID1&quot;) {
        Ok(client_id) =&gt; println!(&quot;Client ID: {}&quot;, client_id),
        Err(e) =&gt; panic!(&quot;Couldn&#x27;t read CLIENT_ID ({})&quot;, e),
    };
    match std::env::var(&quot;CLIENT_SECRET1&quot;) {
        Ok(client_secret) =&gt; println!(&quot;Client Secret: {}&quot;, client_secret),
        Err(e) =&gt; panic!(&quot;Couldn&#x27;t read CLIENT_SECRET ({})&quot;, e),
    };
}
</code></pre><p>Since our bot wont work without a <code>client_id</code> and a <code>client_secret</code> we call <a href="https://doc.rust-lang.org/stable/std/macro.panic.html">panic!</a> so that the application exits with an error.</p><pre><code class="language-shell">(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.41s
     Running `target/debug/vyom`
thread &#x27;main&#x27; panicked at \&#x27;Couldn\&#x27;t read CLIENT_ID (environment variable not found), 
src/main.rs:9:19
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace

# Set the environment variables
(base) DeltaManiac @ ~/git/rust/vyom
└─ $ export CLIENT_SECRET=UItY35BYBEN_rFVnGVzud9Pig6g
(base) DeltaManiac @ ~/git/rust/vyom
└─ $ export CLIENT_ID=SmQ7CzGkKA62yA

(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.47s
     Running `target/debug/vyom`
Client ID: SmQ7CzGkKA62yA
Client Secret: UItY35BYBEN_rFVnGVzud9Pig6g
</code></pre><p>Most of the time we don&#x27;t really want to export a lot of environment variables manually. Its exhausting. We could fix this problem by writing a shell script that has all our <code>export</code> statement... or we can use <a href="https://crates.io/crates/dotenv">dotenv</a>. Dotenv is a way to put environment variables in a <code>.env</code> file and read them. Dotenv is smart to enough to only read from the file if the Environment Variable is not set on the system.</p><p>We first add the <code>dotenv</code> dependency to our <code>Cargo.toml</code> file.</p><pre><code class="language-toml"># Cargo.toml
[package]
name = &quot;vyom&quot;
version = &quot;0.1.0&quot;
authors = [&quot;DeltaManiac &lt;maxpaynered@gmail.com&gt;&quot;]
edition = &quot;2018&quot;

[dependencies]
dotenv_codegen=&quot;0.15.0&quot; # dotenv dependency
</code></pre><p>We then setup the environment variables in the <code>.env</code> file.</p><pre><code class="language-shell"># .env
CLIENT_ID=test_123
CLIENT_SECRET=test_321
Test=DisTest
</code></pre><p>We finally modify our code to use the <code>dotenv</code> crate.</p><pre><code class="language-rust"># main.rs

#[macro_use]
extern crate dotenv_codegen;

fn main(){
    println!(&quot;Env Not on Sys: {}&quot;,dotenv!(&quot;Test&quot;));
    println!(&quot;Client ID: {}&quot;,dotenv!(&quot;CLIENT_ID&quot;));
    println!(&quot;Client Secret: {}&quot;,dotenv!(&quot;CLIENT_SECRET&quot;));
}
</code></pre><pre><code class="language-shell">(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.08s
     Running `target/debug/vyom`
Env Not on Sys: ss #Value from the .env file
Client ID: SmQ7CzGkKA62yA #Value from the system
Client Secret: UItY35BYBEN_rFVnGVzud9Pig6g #Value from the system
</code></pre><h1 id="how-will-the-bot-work-" style="position:relative">How will the bot work ?</h1><p>The bot will listen to a mention like <code>/u/VyomBot</code> and would check if the post is a link to a youtube playlist or the parent comment of the mention is a YouTube playlist.</p><h1 id="setting-up-reddit" style="position:relative">Setting up Reddit</h1><p>I&#x27;ve followed the following steps to setup reddit for testing/developing this bot</p><ol><li><p>Created a new user called <a href="https://old.reddit.com/user/VyomBot">VyomBot</a> so that the bot can be mentioned via <code>/u/VyomBot</code></p></li><li><p>Registered a new app of <code>script</code> type for <code>/u/VyomBot</code></p></li><li><p>Create a new <a href="https://old.reddit.com/ur/VyomBot">subreddit</a> <code>/r/VyomBot</code> as a test play ground.</p></li></ol><p><img src="https://dev-to-uploads.s3.amazonaws.com/i/vgu4s3kk5s6bxvdrhdrh.png" alt="/r/VyomBot"/></p><ol start="4"><li><p>Create a new <a href="https://www.reddit.com/r/VyomBot/comments/i6fk15/test_playlist/?">post</a> with the link to the playlist.</p></li><li><p>Mention <code>/u/VyomBot</code> in the comments.
<img src="https://dev-to-uploads.s3.amazonaws.com/i/vriyg18m5dgc5k8rklc4.png" alt="Alt Text"/></p></li></ol><h1 id="talking-to-reddit" style="position:relative">Talking to Reddit</h1><h2 id="getting-messages-from-inbox" style="position:relative">Getting Messages from Inbox</h2><p>Lets start off by querying reddit to see if we have a new mention and printing the message. We will use the <a href="https://crates.io/crates/roux">roux</a> crate for interacting with the reddit apis.
Direct quote from the description of the crate</p><blockquote><p>A simple, asynchronous Reddit API wrapper implemented in Rust.
This means that we have to use a framework like <a href="https://crates.io/crates/tokio">tokio</a> to provide the async runtime for our bot.
Lets go about doing that.</p></blockquote><p>Add the dependencies to our Cargo.toml file.</p><pre><code class="language-toml"># Cargo.toml
[package]
name = &quot;vyom&quot;
version = &quot;0.1.0&quot;
authors = [&quot;DeltaManiac &lt;maxpaynered@gmail.com&gt;&quot;]
edition = &quot;2018&quot;

[dependencies]
dotenv_codegen=&quot;0.15.0&quot; # dotenv dependency
roux=&quot;1.0.0&quot; # roux dependency
tokio = {version=&quot;0.2.22&quot;,features=[&quot;macros&quot;]} # tokio dependency and only enable the macro feature
</code></pre><p>Update our code to use the library and call the reddit apis.</p><pre><code class="language-rust"># main.rs

#[macro_use]
extern crate dotenv_codegen;
#[macro_use]
extern crate log; // Used for logging
use roux::Reddit;

#[tokio::main]
async fn main() {
    match Reddit::new(
        dotenv!(&quot;VYOM_USERAGENT&quot;),
        dotenv!(&quot;VYOM_CLIENT_ID&quot;),
        dotenv!(&quot;VYOM_CLIENT_SECRET&quot;),
    )
    .username(dotenv!(&quot;VYOM_USERNAME&quot;))
    .password(dotenv!(&quot;VYOM_PASSWORD&quot;))
    .login()
    .await
    {   // Try to make a new client with the credentials
        Ok(client) =&gt; match client.inbox().await {
            // Fetch the inbox of the logged in user
            Ok(listing) =&gt; {
                println!(&quot;Message Count {}&quot;, listing.data.children.len());
                dbg!(listing.data.children.get(0).unwrap());
            }
            Err(_) =&gt; {
                error!(&quot;Failed to fetch messages&quot;);
            }
        },
        Err(e) =&gt; panic!(e),
    }
}

</code></pre><p>When we run the program we get the number of messages we have and the <code>dbg!</code> macro shows what the passed in variable which in this case is a <code>InboxItem</code> struct, looks like.</p><pre><code class="language-shell">(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 3.71s
     Running `target/debug/vyom`
Message Count 5
[src/main.rs:24] &amp;listing.data.children.get(0).unwrap().data = InboxItem {
    id: &quot;g0vfbra&quot;,
    subject: &quot;username mention&quot;,
    was_comment: true,
    author: Some(
        &quot;DeltaManiac&quot;,
    ),
    parent_id: Some(
        &quot;t3_i6fk15&quot;,
    ),
    subreddit_name_prefixed: Some(
        &quot;r/VyomBot&quot;,
    ),
    new: true, 
    type: &quot;username_mention&quot;,
    body: &quot;/u/VyomBot&quot;,
    dest: &quot;VyomBot&quot;,
    body_html: &quot;&amp;lt;!-- SC_OFF --&amp;gt;&amp;lt;div class=\&quot;md\&quot;&amp;gt;&amp;lt;p&amp;gt;&amp;lt;a href=\&quot;/u/VyomBot\&quot;&amp;gt;/u/VyomBot&amp;lt;/a&amp;gt;&amp;lt;/p&amp;gt;\n&amp;lt;/div&amp;gt;&amp;lt;!-- SC_ON --&amp;gt;&quot;,
    name: &quot;t1_g0vfbra&quot;,
    created: 1596987973.0,
    created_utc: 1596959173.0,
    context: &quot;/r/VyomBot/comments/i6fk15/test_playlist/g0vfbra/?context=3&quot;,
}
</code></pre><p>We can use the <code>new</code> property to identify if this is a message that we had previously read.
The type property can be used to determine if the item is a comment or a username mention.
We can use this to iterate over the messages retrieved and  and determine the messages that we have to reply to.</p><h1 id="replying-to-the-message" style="position:relative">Replying to the message</h1><p>Roux provides us a convenient method aptly name <code>comment</code> to reply to the message. Let&#x27;s go ahead and use this to reply to the message.</p><pre><code class="language-rust"># main.rs

async fn main() {
...
...
// Fetch the inbox of the logged in user
    Ok(listing) =&gt; {
        for message in listing.data.children.iter() {
            is message unread and of type &quot;username_mention&quot;
            if message.data.new &amp;&amp; message.data.r#type == &quot;username_mention&quot; {
                match client
                    .comment(
                        &quot;You have been Noted by Vyom. Please Stand By!&quot;,
                        &amp;message.data.name.as_str(),
                    )
                    .await
                {
                    Ok(_) =&gt; info!(&quot;Replied to {}&quot;, message.data.name),
                    Err(_) =&gt; error!(&quot;Failed to reply to mention&quot;),
                };
            }
        }
    }
...
...
</code></pre><blockquote><p>Psst.., I&#x27;ll let you in on something cool. In rust <code>type</code> is a reserved keyword. In most programming languages you can use a keyword only as keyword, e.g. you <em>cannot</em> have a variable called <code>for</code>. In rust we can use <code>type</code> as an attribute of a struct and access it by specifing it as a raw string using the <code>r#</code> like <code>message.data.r#type</code></p></blockquote><p>Now that we have written the code lets run it and see what happens..</p><pre><code class="language-shell">(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 4.45s
     Running `target/debug/vyom`
</code></pre><p>Nice! It logged that we replied to the mention. Lets run it again, this time it should not reply to an allready replied message as we have read it.</p><pre><code class="language-shell">[2020-08-09T12:59:25Z INFO  vyom] Replied to t1_g0vfbra
(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.10s
     Running `target/debug/vyom`
[2020-08-09T12:59:29Z INFO  vyom] Replied to t1_g0vfbra
(base) DeltaManiac @ ~/git/rust/vyom
└─ $ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.09s
     Running `target/debug/vyom`
[2020-08-09T12:59:32Z INFO  vyom] Replied to t1_g0vfbra
</code></pre><p>Damn! IT REPLIED AGAIN!!! And this is what the subbreddit looks like.</p><p><img src="https://dev-to-uploads.s3.amazonaws.com/i/fdjrhs96s7yujerdqbu8.png" alt="replies,Replies,REPLIES"/></p><p>I guess this a good place to stop.
In the next part we will find the reason for this pesky little bug and squash it.</p><div class="references-block"><h3>Referred in</h3><div><div><a class="reference" href="/foam/rust"><div><h5>Rust</h5></div></a></div></div></div></div><a aria-current="page" class="obstructed-label" href="/foam/vyom">Vyom</a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/vyom";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-fd7ae9db326d5475b438.js"],"app":["/app-a23c3f4de5f92c6458ad.js"],"component---node-modules-gatsby-theme-garden-src-templates-local-file-js":["/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-5e093f5807d6eb5ecced.js"]};/*]]>*/</script><script src="/foam/polyfill-fd7ae9db326d5475b438.js" nomodule=""></script><script src="/foam/webpack-runtime-23d80780450712e11cfe.js" async=""></script><script src="/foam/framework-8c8d363c63d1a9a80d21.js" async=""></script><script src="/foam/app-a23c3f4de5f92c6458ad.js" async=""></script><script src="/foam/styles-89fd2ae28bdf06750a71.js" async=""></script><script src="/foam/component---node-modules-gatsby-theme-garden-src-templates-local-file-js-5e093f5807d6eb5ecced.js" async=""></script></body></html>